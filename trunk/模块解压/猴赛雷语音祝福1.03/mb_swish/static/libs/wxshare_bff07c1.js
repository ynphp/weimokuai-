!function(n,e){"function"==typeof define&&define.amd?define(["wx","auth","ngapi"],function(i,o,c){return e(i,o,c,n)}):"undefined"!=typeof module&&module.exports?module.exports=e(require("wx"),require("oAuth"),require("ngapi"),n):n.ngapi=e(n.wx,n.oAuth,n.ngapi,n)}("undefined"!=typeof window?window:this,function(n,e,i,o){var c=o.wxshare={times:0,wxconfig:null,initWx:function(n,e,c,t,s,u,r,a){var l=this;0==l.times?i("jscfg",{url:o.location.href},e,function(i){var o=parseInt(i.error);0==o?(l.times++,l.wxconfig=i.cfg,l.initWxCfg(n,l.wxconfig,e,c,t,s,u,r,a)):alert(i.error_msg)},c,t):l.initWxCfg(n,l.wxconfig,e,c,t,s,u,r,a)},initWxAuth:function(n,i,o,c,t,s){var u=this;e.cfg(i,!1),e.checkToken(function(e,r){u.initWx(n,i,e,r,o,c,t,s)},function(){})},initWxCfg:function(e,i,o,c,t,s,u,r,a){var l=this;n.config({appId:i.appId,timestamp:i.timestamp,nonceStr:i.nonceStr,signature:i.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideOptionMenu","showOptionMenu","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice"]}),n.ready(function(){a&&a(n),n.onMenuShareAppMessage({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){l.statics("sharefriend",o,c,t),s&&s()},cancel:function(){u&&u()}}),n.onMenuShareTimeline({title:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){l.statics("sharetimeline",o,c,t),s&&s()},cancel:function(){u&&u()}}),n.onMenuShareQQ({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){l.statics("QQ",o,c,t),s&&s()},cancel:function(){u&&u()}}),n.onMenuShareWeibo({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){l.statics("tencentWeibo",o,c,t),s&&s()},cancel:function(){u&&u()}})}),n.error(function(n){r&&r(JSON.stringify(n))})},startRecord:function(){n.startRecord()},stopRecord:function(e){n.stopRecord({success:function(n){e&&e(n)}})},onVoiceRecordEnd:function(e,i,o,c){n.onVoiceRecordEnd({complete:function(n){c&&c(n)}})},playVoice:function(e){n.playVoice({localId:e})},pauseVoice:function(e){n.pauseVoice({localId:e})},stopVoice:function(e){n.stopVoice({localId:e})},onVoicePlayEnd:function(e,i,o){n.onVoicePlayEnd({success:function(n){e&&e(n)},fail:function(){o&&o()}})},uploadVoice:function(e,i){n.uploadVoice({localId:e,isShowProgressTips:1,success:function(n){i&&i(n)}})},downloadVoice:function(e,i){n.downloadVoice({serverId:e,isShowProgressTips:1,success:function(n){i&&i(n)}})},statics:function(n,e,o,c){var t=this;i("statics",{channel:e,evtkey:t.getPageName()+"--"+n},e,null,o,c)},getPageName:function(){var n=o.location.href,e=(n.length,n.lastIndexOf("/")),i=n.substr(e+1),c=i.indexOf(-1!=i.indexOf(".")?".":"?"),t=i.substr(0,c);return t},checkJsApi:function(e,i){e=e?e:["startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","onVoicePlayEnd","uploadVoice","downloadVoice"],n.checkJsApi({jsApiList:e,success:function(n){i&&i(n)}})}};return c});